<div id="tasks-by-person" class="card stat-card rounded-4 mb-4 sticky-sidebar">
  <div class="card-body p-3 p-md-4">
    <h6 class="mb-1 dashboard-section-title">Répartition par personne</h6>
    <p class="text-secondary small mb-4">Tâches en cours assignées</p>

    <% if tasks_by_person.any? %>
      <% tasks_by_person.each_with_index do |data, index| %>
        <div class="<%= index < tasks_by_person.length - 1 ? 'mb-3' : '' %>">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <div class="d-flex align-items-center">
              <div class="rounded-circle d-flex align-items-center justify-content-center me-2" style="width: 32px; height: 32px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                <span class="small fw-medium text-white"><%= data[:person].name.first.upcase %></span>
              </div>
              <span class="small"><%= data[:person].name %></span>
            </div>
            <span class="small" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-weight: 600;"><%= data[:completed_tasks] %>/<%= data[:total_tasks] %></span>
          </div>
          <div class="progress" style="height: 8px; background: rgba(102, 126, 234, 0.1); border-radius: 4px;">
            <div class="progress-bar" style="width: <%= data[:total_tasks] > 0 ? (data[:completed_tasks].to_f / data[:total_tasks] * 100).round : 0 %>%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 4px;"></div>
          </div>
        </div>
      <% end %>
    <% else %>
      <div class="text-center py-4">
        <div class="rounded-circle d-flex align-items-center justify-content-center mx-auto mb-3" style="width: 48px; height: 48px; background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" stroke="url(#iconGradient)" stroke-width="1.5" stroke-linecap="round"></path>
            <circle cx="9" cy="7" r="4" stroke="url(#iconGradient)" stroke-width="1.5"></circle>
          </svg>
        </div>
        <p class="text-muted small mb-0">Aucune personne pour le moment</p>
      </div>
    <% end %>
  </div>
</div>
