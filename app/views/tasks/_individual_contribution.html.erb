<div id="individual-contribution" class="card stat-card rounded-4 h-100">
  <div class="card-body p-3 p-md-4">
    <h6 class="mb-1 dashboard-section-title">Contribution individuelle</h6>
    <p class="text-secondary small mb-4">La to-do en volume par personne</p>

    <% if tasks_by_person.any? %>
      <% tasks_by_person.each_with_index do |data, index| %>
        <% if data[:total_tasks] > 0 %>
          <div class="<%= index < tasks_by_person.length - 1 ? 'mb-4' : '' %>">
            <div class="d-flex align-items-center justify-content-between mb-2">
              <div class="d-flex align-items-center">
                <div class="rounded-circle d-flex align-items-center justify-content-center me-2" style="width: 32px; height: 32px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                  <span class="small fw-medium text-white"><%= data[:person].name.first.upcase %></span>
                </div>
                <span class="small"><%= data[:person].name %></span>
              </div>
              <small style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-weight: 500;"><%= data[:completed_tasks] %>/<%= data[:total_tasks] %> terminées</small>
            </div>
            <div class="progress" style="height: 24px; background: rgba(102, 126, 234, 0.1); border-radius: 12px;">
              <% percentage = data[:total_tasks] > 0 ? (data[:completed_tasks].to_f / data[:total_tasks] * 100).round : 0 %>
              <div class="progress-bar d-flex align-items-center justify-content-center" style="width: <%= percentage %>%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; font-size: 12px; font-weight: 500;"><%= percentage %>%</div>
            </div>
          </div>
        <% end %>
      <% end %>

      <div class="d-flex justify-content-center gap-4 mt-4 pt-3 border-top">
        <div class="d-flex align-items-center">
          <div class="rounded-circle" style="width: 12px; height: 12px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"></div>
          <span class="ms-2 small">Terminées</span>
        </div>
        <div class="d-flex align-items-center">
          <div class="rounded-circle" style="width: 12px; height: 12px; background: rgba(102, 126, 234, 0.15);"></div>
          <span class="ms-2 small">En cours</span>
        </div>
      </div>
    <% else %>
      <div class="text-center py-4">
        <div class="rounded-circle d-flex align-items-center justify-content-center mx-auto mb-3" style="width: 64px; height: 64px; background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none">
            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" stroke="url(#iconGradient)" stroke-width="1.5" stroke-linecap="round"></path>
            <circle cx="9" cy="7" r="4" stroke="url(#iconGradient)" stroke-width="1.5"></circle>
          </svg>
        </div>
        <p class="text-muted mb-0">Aucune tâche assignée pour le moment</p>
      </div>
    <% end %>
  </div>
</div>
